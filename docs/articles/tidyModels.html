<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>tidyModels â€¢ autostats</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="tidyModels">
<meta property="og:description" content="autostats">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-KQ5VTRKQF1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-KQ5VTRKQF1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">autostats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/autostats.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/tidyModels.html">tidyModels</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Harrison4192/autostats" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://harrison4192.github.io/TidyConsultant/" class="external-link">TC</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>tidyModels</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Harrison4192/autostats/blob/HEAD/vignettes/tidyModels.Rmd" class="external-link"><code>vignettes/tidyModels.Rmd</code></a></small>
      <div class="hidden name"><code>tidyModels.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://harrison4192.github.io/autostats/" class="external-link">autostats</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/workflows" class="external-link">workflows</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/tune" class="external-link">tune</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rsample.tidymodels.org" class="external-link">rsample</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/hardhat" class="external-link">hardhat</a></span><span class="op">)</span></code></pre></div>
<p><code>autostats</code> provides convenient wrappers for modeling, visualizing, and predicting using a tidy workflow. The emphasis is on rapid iteration and quick results using an intuitive interface based off the <code>tibble</code> and <code>tidy_formula</code>.</p>
<div class="section level1">
<h1 id="prepare-data">Prepare data<a class="anchor" aria-label="anchor" href="#prepare-data"></a>
</h1>
<p>Set up the iris data set for modeling. Create dummies and any new columns before making the formula. This way the same formula can be use throughout the modeling and prediction process.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">34</span><span class="op">)</span>

 <span class="va">iris</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">framecleaner</span><span class="fu">::</span><span class="fu"><a href="https://harrison4192.github.io/framecleaner/reference/create_dummies.html" class="external-link">create_dummies</a></span><span class="op">(</span>remove_first_dummy  <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">iris1</span>
<span class="co">#&gt; 1 column(s) have become 2 dummy columns</span>

 <span class="va">iris1</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
 <span class="fu"><a href="../reference/tidy_formula.html">tidy_formula</a></span><span class="op">(</span>target <span class="op">=</span> <span class="va">Petal.Length</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">petal_form</span>
 
 <span class="va">petal_form</span>
<span class="co">#&gt; Petal.Length ~ Sepal.Length + Sepal.Width + Petal.Width + Species_versicolor + </span>
<span class="co">#&gt;     Species_virginica</span>
<span class="co">#&gt; &lt;environment: 0x7feba68505f8&gt;</span></code></pre></div>
<p>Use the rsample package to split into train and validation sets.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">iris1</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">rsample</span><span class="fu">::</span><span class="fu"><a href="https://rsample.tidymodels.org/reference/initial_split.html" class="external-link">initial_split</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">iris_split</span>

<span class="va">iris_split</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">rsample</span><span class="fu">::</span><span class="fu"><a href="https://rsample.tidymodels.org/reference/as.data.frame.rsplit.html" class="external-link">analysis</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">iris_train</span>

<span class="va">iris_split</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">rsample</span><span class="fu">::</span><span class="fu"><a href="https://rsample.tidymodels.org/reference/as.data.frame.rsplit.html" class="external-link">assessment</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">iris_val</span>

<span class="va">iris_split</span>
<span class="co">#&gt; &lt;Analysis/Assess/Total&gt;</span>
<span class="co">#&gt; &lt;112/38/150&gt;</span></code></pre></div>
</div>
<div class="section level1">
<h1 id="fit-boosting-models-and-visualize">Fit boosting models and visualize<a class="anchor" aria-label="anchor" href="#fit-boosting-models-and-visualize"></a>
</h1>
<p>Fit models to the training set using the formula to predict <code>Petal.Length</code>. Variable importance using gain for each <code>xgboost</code> model can be visualized.</p>
<div class="section level2">
<h2 id="xgboost-with-bayesian-hyperparameter-optimization">xgboost with bayesian hyperparameter optimization<a class="anchor" aria-label="anchor" href="#xgboost-with-bayesian-hyperparameter-optimization"></a>
</h2>
<p><code>auto_tune_xgboost</code> returns a workflow object with tuned parameters and requires some postprocessing to get a traind <code>xgb.Booster</code> object like <code>tidy_xgboost</code>. Tuning iterations set to <code>1</code> just so the vignette builds quickly. Default is <code>n_iter = 100</code></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">iris_train</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/auto_tune_xgboost.html">auto_tune_xgboost</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">petal_form</span>, n_iter <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">xgb_tuned</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #000000;">&gt;</span> <span style="color: #000000;"> Generating a set of 10 initial parameter results</span></span>
<span class="co">#&gt; <span style="color: #BBBB00;">!</span> <span style="color: #BBBB00;">Fold1: internal: A correlation computation is required, but `estimate` is const...</span></span>
<span class="co">#&gt; <span style="color: #BBBB00;">!</span> <span style="color: #BBBB00;">Fold2: internal: A correlation computation is required, but `estimate` is const...</span></span>
<span class="co">#&gt; <span style="color: #BBBB00;">!</span> <span style="color: #BBBB00;">Fold3: internal: A correlation computation is required, but `estimate` is const...</span></span>
<span class="co">#&gt; <span style="color: #BBBB00;">!</span> <span style="color: #BBBB00;">Fold4: internal: A correlation computation is required, but `estimate` is const...</span></span>
<span class="co">#&gt; <span style="color: #BBBB00;">!</span> <span style="color: #BBBB00;">Fold5: internal: A correlation computation is required, but `estimate` is const...</span></span>
<span class="co">#&gt; <span style="color: #00BB00;">âœ“</span> <span style="color: #000000;">Initialization complete</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Optimizing rmse using the expected improvement</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; â”€â”€ <span style="font-weight: bold;">Iteration 1</span> â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; <span style="color: #0000BB;">i</span> <span style="color: #000000;">Current best:       rmse=0.354 (@iter 0)</span></span>
<span class="co">#&gt; <span style="color: #0000BB;">i</span> <span style="color: #000000;">Gaussian process model</span></span>
<span class="co">#&gt; <span style="color: #00BB00;">âœ“</span> <span style="color: #000000;">Gaussian process model</span></span>
<span class="co">#&gt; <span style="color: #0000BB;">i</span> <span style="color: #000000;">Generating 5000 candidates</span></span>
<span class="co">#&gt; <span style="color: #0000BB;">i</span> <span style="color: #000000;">Predicted candidates</span></span>
<span class="co">#&gt; <span style="color: #0000BB;">i</span> <span style="color: #000000;">mtry=1, trees=8, min_n=32, tree_depth=13, learn_rate=0.0103,</span></span>
<span class="co">#&gt;   <span style="color: #000000;">loss_reduction=0.00135, sample_size=0.884</span></span>
<span class="co">#&gt; <span style="color: #0000BB;">i</span> <span style="color: #000000;">Estimating performance</span></span>
<span class="co">#&gt; <span style="color: #BBBB00;">!</span> <span style="color: #BBBB00;">Fold1: preprocessor 1/1, model 1/1: `early_stop` was reduced to 7.</span></span>
<span class="co">#&gt; <span style="color: #BBBB00;">!</span> <span style="color: #BBBB00;">Fold2: preprocessor 1/1, model 1/1: `early_stop` was reduced to 7.</span></span>
<span class="co">#&gt; <span style="color: #BBBB00;">!</span> <span style="color: #BBBB00;">Fold3: preprocessor 1/1, model 1/1: `early_stop` was reduced to 7.</span></span>
<span class="co">#&gt; <span style="color: #BBBB00;">!</span> <span style="color: #BBBB00;">Fold4: preprocessor 1/1, model 1/1: `early_stop` was reduced to 7.</span></span>
<span class="co">#&gt; <span style="color: #BBBB00;">!</span> <span style="color: #BBBB00;">Fold5: preprocessor 1/1, model 1/1: `early_stop` was reduced to 7.</span></span>
<span class="co">#&gt; <span style="color: #00BB00;">âœ“</span> <span style="color: #000000;">Estimating performance</span></span>
<span class="co">#&gt; <span style="color: #555555;">â“§</span> Newest results:  rmse=3.36 (+/-0.113)</span>

<span class="va">xgb_tuned</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">fit</span><span class="op">(</span><span class="va">iris_train</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">hardhat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/hardhat/man/hardhat-extract.html" class="external-link">extract_fit_engine</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">xgb_tuned_fit</span>

<span class="va">xgb_tuned_fit</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/visualize_model.html">visualize_model</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="tidyModels_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="xgboost-with-default-parameters">xgboost with default parameters<a class="anchor" aria-label="anchor" href="#xgboost-with-default-parameters"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">iris_train</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/tidy_xgboost.html">tidy_xgboost</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">petal_form</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">xgb_base</span>
<span class="co">#&gt; Warning: `early_stop` was reduced to 14.</span>

<span class="va">xgb_base</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/visualize_model.html">visualize_model</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="tidyModels_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="xgboost-with-hand-picked-parameters">xgboost with hand-picked parameters<a class="anchor" aria-label="anchor" href="#xgboost-with-hand-picked-parameters"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">iris_train</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/tidy_xgboost.html">tidy_xgboost</a></span><span class="op">(</span><span class="va">petal_form</span>, 
               trees <span class="op">=</span> <span class="fl">500</span>, 
               tree_depth <span class="op">=</span> <span class="fl">3</span>, 
               sample_size <span class="op">=</span> <span class="fl">.5</span>,
               mtry <span class="op">=</span> <span class="fl">3</span>,
               min_n <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">xgb_opt</span>
<span class="co">#&gt; Warning: `early_stop` was reduced to 499.</span>

<span class="va">xgb_opt</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/visualize_model.html">visualize_model</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="tidyModels_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="agtboost">agtboost<a class="anchor" aria-label="anchor" href="#agtboost"></a>
</h2>
<p>automated gradient descent boosting with information-criterion heuristics that donâ€™t need tuning</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">iris_train</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/tidy_agtboost.html">tidy_agtboost</a></span><span class="op">(</span><span class="va">petal_form</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">agtb</span>
<span class="co">#&gt; no dummies were created</span></code></pre></div>
<p><img src="tidyModels_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
</div>
<div class="section level1">
<h1 id="predict-on-validation-set">predict on validation set<a class="anchor" aria-label="anchor" href="#predict-on-validation-set"></a>
</h1>
<div class="section level2">
<h2 id="make-predictions">make predictions<a class="anchor" aria-label="anchor" href="#make-predictions"></a>
</h2>
<p>Predictions are iteratively added to the validation data frame. The name of the column is automatically created using the models name and the prediction target.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">xgb_tuned_fit</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/tidy_predict.html">tidy_predict</a></span><span class="op">(</span>newdata <span class="op">=</span> <span class="va">iris_val</span>, form <span class="op">=</span> <span class="va">petal_form</span><span class="op">)</span>  <span class="op">-&gt;</span> <span class="va">iris_val1</span>

<span class="va">xgb_base</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/tidy_predict.html">tidy_predict</a></span><span class="op">(</span>newdata <span class="op">=</span> <span class="va">iris_val1</span>, form <span class="op">=</span> <span class="va">petal_form</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">iris_val2</span>

<span class="va">xgb_opt</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/tidy_predict.html">tidy_predict</a></span><span class="op">(</span>newdata <span class="op">=</span> <span class="va">iris_val2</span>, <span class="va">petal_form</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">iris_val3</span>

<span class="va">agtb</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
    <span class="fu"><a href="../reference/tidy_predict.html">tidy_predict</a></span><span class="op">(</span>newdata <span class="op">=</span> <span class="va">iris_val3</span>, <span class="va">petal_form</span><span class="op">)</span><span class="op">-&gt;</span> <span class="va">iris_val4</span>

<span class="va">iris_val4</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt;  [1] "Sepal.Length"                     "Sepal.Width"                     </span>
<span class="co">#&gt;  [3] "Petal.Length"                     "Petal.Width"                     </span>
<span class="co">#&gt;  [5] "Species_versicolor"               "Species_virginica"               </span>
<span class="co">#&gt;  [7] "Petal.Length_preds_xgb_tuned_fit" "Petal.Length_preds_xgb_base"     </span>
<span class="co">#&gt;  [9] "Petal.Length_preds_xgb_opt"       "Petal.Length_preds_agtb"</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="compare-predictions-using-yardstick">Compare predictions using yardstick<a class="anchor" aria-label="anchor" href="#compare-predictions-using-yardstick"></a>
</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span>

<span class="va">iris_val4</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">yardstick</span><span class="fu">::</span><span class="fu"><a href="https://yardstick.tidymodels.org/reference/rmse.html" class="external-link">rmse</a></span><span class="op">(</span>truth <span class="op">=</span> <span class="va">Petal.Length</span>, estimate <span class="op">=</span> <span class="va">Petal.Length_preds_xgb_tuned_fit</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"tuned"</span><span class="op">)</span>,

<span class="va">iris_val4</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">yardstick</span><span class="fu">::</span><span class="fu"><a href="https://yardstick.tidymodels.org/reference/rmse.html" class="external-link">rmse</a></span><span class="op">(</span>truth <span class="op">=</span> <span class="va">Petal.Length</span>, estimate <span class="op">=</span> <span class="va">Petal.Length_preds_xgb_base</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"baseline"</span><span class="op">)</span>,

<span class="va">iris_val4</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">yardstick</span><span class="fu">::</span><span class="fu"><a href="https://yardstick.tidymodels.org/reference/rmse.html" class="external-link">rmse</a></span><span class="op">(</span>truth <span class="op">=</span> <span class="va">Petal.Length</span>, estimate <span class="op">=</span> <span class="va">Petal.Length_preds_xgb_opt</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"hand_picked"</span><span class="op">)</span>,

<span class="va">iris_val4</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">yardstick</span><span class="fu">::</span><span class="fu"><a href="https://yardstick.tidymodels.org/reference/rmse.html" class="external-link">rmse</a></span><span class="op">(</span>truth <span class="op">=</span> <span class="va">Petal.Length</span>, estimate <span class="op">=</span> <span class="va">Petal.Length_preds_agtb</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"agtboost"</span><span class="op">)</span>

<span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 Ã— 4</span></span>
<span class="co">#&gt;   .metric .estimator .estimate model      </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> rmse    standard       0.338 tuned      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> rmse    standard       0.352 baseline   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> rmse    standard       0.364 hand_picked</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> rmse    standard       0.317 agtboost</span></code></pre></div>
</div>
</div>
<div class="section level1">
<h1 id="get-shapley-values">get shapley values<a class="anchor" aria-label="anchor" href="#get-shapley-values"></a>
</h1>
<p><code>tidy_shap</code> has similar syntax to <code>tidy_predict</code> and can be used to get shapley values from <code>xgboost</code> models on a validation set.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">xgb_base</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/tidy_shap.html">tidy_shap</a></span><span class="op">(</span>newdata <span class="op">=</span> <span class="va">iris_val</span>, form <span class="op">=</span> <span class="va">petal_form</span><span class="op">)</span></code></pre></div>
<p><img src="tidyModels_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">xgb_tuned_fit</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/tidy_shap.html">tidy_shap</a></span><span class="op">(</span>newdata <span class="op">=</span> <span class="va">iris_val</span>, form <span class="op">=</span> <span class="va">petal_form</span><span class="op">)</span></code></pre></div>
<p><img src="tidyModels_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Harrison Tietze.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.9000.9000.9000.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
